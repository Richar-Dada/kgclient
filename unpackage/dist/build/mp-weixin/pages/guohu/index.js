(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/guohu/index"],{4531:function(e,n,t){"use strict";t.d(n,"b",(function(){return o})),t.d(n,"c",(function(){return i})),t.d(n,"a",(function(){return r}));var r={uniNoticeBar:function(){return t.e("components/uni-notice-bar/uni-notice-bar").then(t.bind(null,"1163"))},uniForms:function(){return Promise.all([t.e("common/vendor"),t.e("components/uni-forms/uni-forms")]).then(t.bind(null,"12d1"))},uniIcons:function(){return Promise.all([t.e("common/vendor"),t.e("components/uni-icons/uni-icons")]).then(t.bind(null,"c5de"))},uniGroup:function(){return t.e("components/uni-group/uni-group").then(t.bind(null,"0c0b"))},uniFormsItem:function(){return Promise.all([t.e("common/vendor"),t.e("components/uni-forms-item/uni-forms-item")]).then(t.bind(null,"bd5c"))},uniEasyinput:function(){return Promise.all([t.e("common/vendor"),t.e("components/uni-easyinput/uni-easyinput")]).then(t.bind(null,"455b"))},uniDatetimePicker:function(){return t.e("components/uni-datetime-picker/uni-datetime-picker").then(t.bind(null,"039e"))}},o=function(){var e=this,n=e.$createElement;e._self._c},i=[]},"4d67":function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("2f62");function o(e){return c(e)||u(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(e,n){if(e){if("string"===typeof e)return s(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?s(e,n):void 0}}function u(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function c(e){if(Array.isArray(e))return s(e)}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function m(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){f(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function f(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var d={data:function(){return{vehicleLicenseImageList:[],date:"",formData:{carname:"",carId:"",carType:"",carNumber:"",engineNumber:"",startTime:"",endTime:"",remark:""},rules:{carname:{rules:[{required:!0,errorMessage:"请输入品牌型号"}]},carId:{rules:[{required:!0,errorMessage:"请输入车牌号"}]},carType:{rules:[{required:!0,errorMessage:"请输入汽车类型"}]},carNumber:{rules:[{required:!0,errorMessage:"请输入车架号"}]},startTime:{rules:[{required:!0,errorMessage:"请选择指标有效期开始时间"}]},endTime:{rules:[{required:!0,errorMessage:"请选择指标有效期结束时间"}]},remark:{rules:[]}}}},computed:m(m({},(0,r.mapState)(["openid"])),{},{showForm:function(){return this.oldCarBusinessType&&this.newCarBusinessType}}),onLoad:function(e){this.date=e.date,this.goNotice()},onReady:function(){this.$refs.form.setRules(this.rules)},methods:{goNotice:function(){e.navigateTo({url:"../notice/index"})},startDateChange:function(e){this.formData.startTime=e},endDateChange:function(e){this.formData.endTime=e},transformTime:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:+new Date;if(e){var n=new Date(e),t=n.getFullYear(),r=n.getMonth()+1,o=n.getDate();return t+"-"+r+"-"+o}return""},chooseImageVehicleLicense:function(){var n=this;e.chooseImage({count:1,sizeType:[],success:function(t){var r=t.tempFilePaths[0];e.showLoading(),e.uploadFile({url:n.$baseUrl+"/api/v1/upload/vehiclelicense",filePath:r,name:"image",success:function(t){e.hideLoading(),console.log(t);var r=JSON.parse(t.data);if(200===r.code){e.showToast({title:"上传成功",icon:"success",duration:1e3}),n.vehicleLicenseImageList.push(r.data.imageUrl),console.log(r);var o=r.data.FrontInfo;o&&(n.formData.carId=o.PlateNo,n.formData.carNumber=o.Vin,n.formData.carname=o.Model,n.formData.carType=o.VehicleType,n.formData.engineNumber=o.EngineNo)}else e.showToast({title:"图片有误，识别失败",icon:"none"})},fail:function(n){console.log("uploadImage fail",n),e.showModal({content:n.errMsg,showCancel:!1})}})},fail:function(e){console.log("chooseImage fail",e)}})},deleteImage:function(e,n){n.splice(e,1),n=o(n)},submitForm:function(n){var t=this;e.showLoading(),this.$refs[n].submit().then((function(n){var r=t.date.split(" ");t.$request({url:"/api/v1/booking/create/wx",method:"POST",data:{serviceType:"市内过户",bookingDate:r[0],bookingTime:r[1],carNumber:t.formData.carNumber,carname:t.formData.carname,carId:t.formData.carId,carType:t.formData.carType,engineNumber:t.formData.engineNumber,mark:t.formData.mark,createTime:(new Date).getTime(),createBy:t.openid,vehicleLicenseUrl:t.vehicleLicenseImageList&&t.vehicleLicenseImageList[0],validDate:"小型轿车"===t.formData.carType?t.transformTime(t.formData.startTime)+"~"+t.transformTime(t.formData.endTime):" "}}).then((function(n){e.hideLoading(),200===n.code?(e.showToast({title:"提交成功"}),e.$emit("bookingCreate"),setTimeout((function(){e.switchTab({url:"../bookingList/index"})}),1e3)):e.showToast({title:n.msg})}))})).catch((function(e){console.error("验证失败：",e)}))}}};n.default=d}).call(this,t("543d")["default"])},"5e35":function(e,n,t){"use strict";var r=t("75e8"),o=t.n(r);o.a},"6d3c":function(e,n,t){"use strict";t.r(n);var r=t("4d67"),o=t.n(r);for(var i in r)"default"!==i&&function(e){t.d(n,e,(function(){return r[e]}))}(i);n["default"]=o.a},"75e8":function(e,n,t){},b43b:function(e,n,t){"use strict";(function(e){t("9634");r(t("66fd"));var n=r(t("dd34"));function r(e){return e&&e.__esModule?e:{default:e}}e(n.default)}).call(this,t("543d")["createPage"])},dd34:function(e,n,t){"use strict";t.r(n);var r=t("4531"),o=t("6d3c");for(var i in o)"default"!==i&&function(e){t.d(n,e,(function(){return o[e]}))}(i);t("5e35");var a,u=t("f0c5"),c=Object(u["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);n["default"]=c.exports}},[["b43b","common/runtime","common/vendor"]]]);